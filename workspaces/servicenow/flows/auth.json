{
    "id": "get_auth",
    "name": "Get authentication",
    "pipeline": [
        {
            "action": "start",
            "data": {},
            "id": "start",
            "next_action": "flow_var_servicenow"
        },
        {
            "id": "flow_var_servicenow",
            "action": "flow_var",
            "data": {
                "url": "${env.base_url}/oauth_token.do"
            },
            "next_action": "request_post_auth"
        },
        {
            "id": "request_post_auth",
            "action": "request",
            "data": {
                "url": "${flow.url}",
                "method": "POST",
                "headers": {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                "data": {
                    "grant_type": "password",
                    "client_id": "${env.client_id}",
                    "client_secret": "${env.client_secret}",
                    "username": "${env.client_username}",
                    "password": "${env.client_password}"
                },
                "next_action_success": "workspace_var_auth",
                "next_action_fail": "end"
            },
            "next_action": "${pipeline.next_action}"
        },
        {
            "id": "workspace_var_auth",
            "action": "workspace_var",
            "data": {
                "auth": "${response.data}"
            },
            "next_action": "end"
        },
        {
            "id": "end",
            "action": "end",
            "data": {},
            "next_action": null
        }
    ]
}